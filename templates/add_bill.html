{% extends "base.html" %}
{% block title %}Add Bill â€” BillSmart{% endblock %}

{% block content %}
<div data-aos="fade-up" style="max-width:760px;margin:18px auto;">
  <div class="card-glass" style="padding:30px;border-radius:16px;">
    <!-- Header: Cute icon + title -->
    <div style="display:flex;align-items:center;gap:14px;margin-bottom:14px;">
      <div style="width:62px;height:62px;border-radius:14px;display:grid;place-items:center;font-size:28px;background:linear-gradient(180deg,#fff7f2,#fff);box-shadow:var(--shadow-subtle);">
        ðŸ§¾
      </div>
      <div>
        <div style="font-size:20px;font-weight:800">Add New Bill</div>
        <div class="text-muted" style="margin-top:4px;font-size:14px">Manage your expenses â€” add a bill and get reminders.</div>
      </div>
    </div>

    <!-- Form -->
    <form id="addBillForm" method="post" action="{{ url_for('add_bill') }}">
      <div style="display:grid;gap:12px;">
        <label class="h2">Title</label>
        <input name="title" required placeholder="e.g., Electricity bill" style="width:100%;padding:14px;border-radius:10px;border:1px solid rgba(40,55,70,0.04);font-size:15px" />

        <div style="display:grid;grid-template-columns: 1fr 1fr; gap:12px;">
          <div>
            <label class="h2">Amount (â‚¹)</label>
            <input name="amount" type="number" step="0.01" min="0" required placeholder="e.g., 850.00" style="width:100%;padding:14px;border-radius:10px;border:1px solid rgba(40,55,70,0.04);font-size:15px" />
          </div>
          <div>
            <label class="h2">Category</label>
            <input name="category" required placeholder="e.g., Utilities / Rent / Internet" style="width:100%;padding:14px;border-radius:10px;border:1px solid rgba(40,55,70,0.04);font-size:15px" />
          </div>
        </div>

        <div style="display:grid;grid-template-columns: 1fr 1fr; gap:12px;">
          <div>
            <label class="h2">Due Date</label>
            <input name="due_date" type="date" required style="width:100%;padding:12px;border-radius:10px;border:1px solid rgba(40,55,70,0.04);font-size:15px" />
          </div>
          <div>
            <label class="h2">Status</label>
            <select name="status" style="width:100%;padding:12px;border-radius:10px;border:1px solid rgba(40,55,70,0.04);font-size:15px">
              <option value="pending" selected>Pending</option>
              <option value="paid">Paid</option>
            </select>
          </div>
        </div>

        <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:6px;">
          <a href="{{ url_for('dashboard') }}" class="btn" style="padding:10px 14px;border-radius:10px;background:transparent;border:1px solid rgba(40,55,70,0.06);text-decoration:none;color:var(--text)">Cancel</a>
          <button type="submit" class="btn" id="addBtn" style="padding:12px 16px;border-radius:10px;background:linear-gradient(90deg,var(--accent),#6b9bff);color:white;font-weight:700;border:none">Save Bill</button>
        </div>
      </div>
    </form>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('addBillForm').addEventListener('submit', function(e){
  // client side validation and friendly confirm
  const title = this.title.value.trim();
  const amount = parseFloat(this.amount.value);
  const due = this.due_date.value;

  if (!title || isNaN(amount) || amount <= 0 || !due) {
    e.preventDefault();
    Swal.fire({ icon:'warning', title:'Check fields', text:'Please fill valid title, positive amount and due date.'});
    return false;
  }

  // show small loader confirmation then submit
  e.preventDefault();
  Swal.fire({
    title: 'Save bill?',
    html: `<b>${title}</b><br/>Amount: â‚¹${amount.toFixed(2)}<br/>Due: ${due}`,
    showCancelButton: true,
    confirmButtonText: 'Save',
  }).then((res)=>{
    if (res.isConfirmed) this.submit();
  });
});
</script>
{% endblock %}
